# 数据库 <Badge text="P1" type="warning"/> `(7/11)`

- MySQL 的存储引擎了解的有哪些
  - InnoDB、MyISAM、Memory
- 分布式的 cap 理论
- MySQL 和 MongoDB 区别
- MySQL b+ 树索引和 hash 索引的区别
- sql 语句发现运行慢，如何优化
  - 前缀索引优化
  - 覆盖索引优化
  - 主键索引最好是自增的
  - 防止索引失效
- 你怎么知道它（一条 SQL 语句）使用没索引呢？（SHOW INDEX / EXPLAN）
  - key key_len
- 向数据库里读写数据的流程是什么样子？
  - 连接器：建立连接，管理连接、校验用户身份
  - 查询缓存：查询语句如果命中查询缓存则直接返回，否则继续往下执行。MySQL 8.0 已删除该模块
  - 解析 SQL，通过解析器对 SQL 查询语句进行词法分析、语法分析，然后构建语法树，方便后续模块读取表名、字段、语句类型
  - 执行 SQL
    - 预处理阶段：检查表或字段是否存在；将 `select *` 中的 * 符号扩展为表上的所有列
    - 优化阶段：基于查询成本的考虑，选择查询成本最小的执行计划
    - 执行阶段：根据执行计划执行 SQL 查询语句，从存储引擎读取记录，返回给客户端
- 讲讲 MySQL MVCC
  - Read View 中四个字段：creator_trx_id、m_ids、min_trx_id、max_trx_id
  - 聚簇索引记录中两个跟事务有关的隐藏列：trx_id、roll_pointer
  - 通过「版本链」来控制并发事务访问同一个记录时的行为就叫 MVCC（多版本并发控制）
- 什么是幻读？
- 了解覆盖索引吗？什么时候用覆盖索引？
  - query 的所有字段在二级索引的 B+Tree 上都能找到记录不需要再通过聚簇索引执行回表操作
- MySQL 的 ACID
  - 事务特性：原子性（undo log 回滚日志）、一致性（持久性+原子性+隔离性）、隔离性（MVCC）、持久性（redo/undo log）
  - 并行事务问题：脏读、不可重复度、幻读
  - 隔离级别：读未提交、读提交、可重复读、串行化